---
title: "ch1_data_analysis"
author: "Chinmay Joshi"
date: "2023-02-07"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Required libraries
```{r}
library(tidyverse)
library(googlesheets4)
```

Importing datasheets from google drive
These datasheets only contain information on ant choices and abandonment for control and experimental treatments
```{r}

#Importing 1.5M data from two seasons and doing the necessary transformations in the data

fall_2022_1.5m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1VCywNjZ6dYYV7aQSDPEoWkZnwZupzepO-hj_dxjA9II/edit?gid=0#gid=0"))

fall_2023_1.5m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1UvuY_wv78jGxdG5KQwZlSYvwqsPIHxr0fkeslZk4AkM/edit?gid=0#gid=0",sheet="Data_1.5M sucrose"))

fall_2024_1.5m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1lPkGkT4vRmqpSdu5HWjKZL-jaAVoRs118nmB2sqmHtI/edit?gid=0#gid=0",sheet="1.5 M data"))

#Filtering the columns that are needed for the choice and abandonment analyses
fall_2022_1.5m<-fall_2022_1.5m[1:8]
fall_2023_1.5m<-fall_2023_1.5m[1:8]
fall_2024_1.5m<-fall_2024_1.5m[1:8]

#Converting character columns into factors
fall_2022_1.5m<-fall_2022_1.5m %>%
  mutate_if(is.character,as.factor)
fall_2023_1.5m<-fall_2023_1.5m %>%
  mutate_if(is.character,as.factor)
fall_2024_1.5m<-fall_2024_1.5m %>%
  mutate_if(is.character,as.factor)

#Importing 3M data from two seasons

fall_2023_3m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1UvuY_wv78jGxdG5KQwZlSYvwqsPIHxr0fkeslZk4AkM/edit?gid=0#gid=0",sheet="Data_3M sucrose"))

fall_2024_3m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1lPkGkT4vRmqpSdu5HWjKZL-jaAVoRs118nmB2sqmHtI/edit?gid=0#gid=0",sheet="3M data"))

#Filtering the columns that are needed for the choice and abandonment analyses
fall_2023_3m<-fall_2023_3m[1:8]
fall_2024_3m<-fall_2024_3m[1:8]

#Converting character columns into factors
fall_2023_3m<-fall_2023_3m %>%
  mutate_if(is.character,as.factor)
fall_2024_3m<-fall_2024_3m %>%
  mutate_if(is.character,as.factor)

```

############### ANALYZING CHOICES ############################

The correct and wrong choices are not explicitly recorded in the main datasheet. So the ant choice can be extracted by using ifelse statements by comparing the feeder position and the choice that ant made.

1.5M data choice analysis
```{r}
#Fall 2022
fall_2022_1.5m_choices<-fall_2022_1.5m %>%
  filter(`Ant choice`!="Abandoned")

fall_2022_1.5m_choices$`Ant choice`<-droplevels(fall_2022_1.5m_choices$`Ant choice`)

fall_2022_1.5m_choices$`Ant choice`<-ifelse(fall_2022_1.5m_choices$`Ant choice`==fall_2022_1.5m_choices$`Side/arm of feeder`,"Correct","Wrong")

#Fall 2023
fall_2023_1.5m_choices<-fall_2023_1.5m %>%
  filter(`Ant choice`!="Abandoned")

fall_2023_1.5m_choices$`Ant choice`<-droplevels(fall_2023_1.5m_choices$`Ant choice`)

fall_2023_1.5m_choices$`Ant choice`<-ifelse(fall_2023_1.5m_choices$`Ant choice`==fall_2023_1.5m_choices$`Side/arm of feeder`,"Correct","Wrong")

#Fall 2024
fall_2024_1.5m_choices<-fall_2024_1.5m %>%
  filter(`Ant choice`!="Abandoned")

fall_2024_1.5m_choices$`Ant choice`<-droplevels(fall_2024_1.5m_choices$`Ant choice`)

fall_2024_1.5m_choices$`Ant choice`<-ifelse(fall_2024_1.5m_choices$`Ant choice`==fall_2024_1.5m_choices$`Side/arm of feeder`,"Correct","Wrong")

#Combining all the dataframes with ant choices across three seasons
combined_choices<-rbind(fall_2022_1.5m_choices,fall_2023_1.5m_choices,fall_2024_1.5m_choices)

#Filtering ant choices and treatment for fisher's test and binomial test
combined_choices<-data.frame(combined_choices$`Treatment (Control/Experimental)`,combined_choices$`Ant choice`)

colnames(combined_choices)<-c("treatment","choice")

#Converting this data into a table
combined_choices<-table(combined_choices)

fisher.test(combined_choices)
#Significant!

#Binomial test for control data
binom.test(23,27,0.5)
#Significant!

#Binomial test for experimental data
binom.test(4,12,0.5)
#Non-significant 
```

Subsetting as per the setup: Fall 2022 was done on a setup with a slightly smaller T-maze stem so only analyzing Fall 2023 and Fall 2024 data here

Result:

```{r}
combined_choices_setup2<-rbind(fall_2023_1.5m_choices,fall_2024_1.5m_choices)

combined_choices_setup2<-data.frame(combined_choices_setup2$`Treatment (Control/Experimental)`,combined_choices_setup2$`Ant choice`)

colnames(combined_choices_setup2)<-c("treatment","choice")

#Converting this data into a table for the fisher's test
combined_choices_setup2<-table(combined_choices_setup2)

fisher.test(combined_choices_setup2)
#Not significant

#Binomial test for control data
binom.test(14,15,0.5)
#Significant!

#Binomial test for experimental data
binom.test(1,3,0.5)
#Non-significant 


```


Analyzing data from Fall 2022 alone given the experiment was conducted using a slightly smaller setup

Result:

```{r}
setup1<-data.frame(fall_2022_1.5m_choices$`Treatment (Control/Experimental)`,fall_2022_1.5m_choices$`Ant choice`)

colnames(setup1)<-c("treatment","choice")

#Converting this data into a table for the fisher's test
setup1<-table(setup1)

fisher.test(setup1)
#Non-significant

#Binomial test for control data
binom.test(9,12,0.5)
#Not Significant!

#Binomial test for experimental data
binom.test(3,9,0.5)
#Non-significant 


```

3M data choice analysis

```{r}
#Fall 2023
fall_2023_3m_choices<-fall_2023_3m %>%
  filter(`Ant choice`!="Abandoned")

fall_2023_3m_choices$`Ant choice`<-droplevels(fall_2023_3m_choices$`Ant choice`)

fall_2023_3m_choices$`Ant choice`<-ifelse(fall_2023_3m_choices$`Ant choice`==fall_2023_3m_choices$`Side/arm of feeder`,"Correct","Wrong")

#Fall 2024
fall_2024_3m_choices<-fall_2024_3m %>%
  filter(`Ant choice`!="Abandoned")

fall_2024_3m_choices$`Ant choice`<-droplevels(fall_2024_3m_choices$`Ant choice`)

fall_2024_3m_choices$`Ant choice`<-ifelse(fall_2024_3m_choices$`Ant choice`==fall_2024_3m_choices$`Side/arm of feeder`,"Correct","Wrong")

combined_choices_3m<-rbind(fall_2023_3m_choices,fall_2024_3m_choices)

combined_choices_3m<-data.frame(combined_choices_3m$`Treatment (Control/Experimental)`,combined_choices_3m$`Ant choice`)

colnames(combined_choices_3m)<-c("treatment","choice")

#Converting into table for fisher's test
combined_choices_3m<-table(combined_choices_3m)

fisher.test(combined_choices_3m)
#Non-significant

#Binomial test for control data
binom.test(25,31,0.5)
#Significant!

#Binomial test for experimental data
binom.test(9,18,0.5)
#Non-significant 

#Binomial test for control data
binom.test(14,15,0.5)
#Significant!

#Binomial test for experimental data
binom.test(1,3,0.5)
#Non-significant 
 
```


############### ANALYZING ABANDONMENT DATA###########################

Whenever ant makes a choice, it stays on the trail and when it abandons it does not. So transforming the data accordingly and combining the dataframes to analyze abandonment

1.5M abandonment data analysis
```{r}

fall_2022_1.5m$abandonment<-ifelse(fall_2022_1.5m$`Ant choice`=="Abandoned","Abandoned","On-trail")

fall_2023_1.5m$abandonment<-ifelse(fall_2023_1.5m$`Ant choice`=="Abandoned","Abandoned","On-trail")

fall_2024_1.5m$abandonment<-ifelse(fall_2024_1.5m$`Ant choice`=="Abandoned","Abandoned","On-trail")

#Combining all the dataframes
combined_abandonment<-rbind(fall_2022_1.5m,fall_2023_1.5m,fall_2024_1.5m)

combined_abandonment<-data.frame(combined_abandonment$`Treatment (Control/Experimental)`,combined_abandonment$abandonment)

colnames(combined_abandonment)<-c("treatment","abandonment")

combined_abandonment<-table(combined_abandonment)

fisher.test(combined_abandonment)
#Significant!

#Binomial test for control data
binom.test(5,32,0.5)
#Significantly more ants stay on the trail than abandon here


#Binomial test for experimental data
binom.test(39,51,0.5)
#Significantly more ants abandon the trail than stay on the trail

```

3M abandonment data analysis

```{r}
fall_2023_3m$abandonment<-ifelse(fall_2023_3m$`Ant choice`=="Abandoned","Abandoned","On-trail")

fall_2024_3m$abandonment<-ifelse(fall_2024_3m$`Ant choice`=="Abandoned","Abandoned","On-trail")

 
#Combining all the dataframes
combined_abandonment_3m<-rbind(fall_2023_3m,fall_2024_3m)

combined_abandonment_3m<-data.frame(combined_abandonment_3m$`Treatment (Control/Experimental)`,combined_abandonment_3m$abandonment)

colnames(combined_abandonment_3m)<-c("treatment","abandonment")

#Converting data into a table for fisher's test
combined_abandonment_3m<-table(combined_abandonment_3m)

fisher.test(combined_abandonment_3m)
#Significant!

#Binomial test for control data
binom.test(2,33,0.5)
#Significantly more ants stay on the trail than abandon here

#Binomial test for experimental data
binom.test(22,40,0.5)
#Non-significant

```

############# COMPARING 1.5M AND 3M EXPERIMENTS TO FIND IF THE SUCROSE CONCENTRATION INCREASE CHANGED CHOICE MAKING OR ABANDONMENT PATTERN IN ANTS######################


Comparing correct vs. wrong choices across 1.5M and 3M treatments
```{r}

combined_choices<-rbind(fall_2022_1.5m_choices,fall_2023_1.5m_choices,fall_2024_1.5m_choices)

#Creating a new column with the treatment and experiment label
combined_choices$treatment_label<-ifelse(combined_choices$`Treatment (Control/Experimental)`=="Control","Control_1.5m","Exp_1.5m")

combined_choices_3m<-rbind(fall_2023_3m_choices,fall_2024_3m_choices)

#Creating a new column with the treatment and experiment label
combined_choices_3m$treatment_label<-ifelse(combined_choices_3m$`Treatment (Control/Experimental)`=="Control","Control_3m","Exp_3m")

all_exp_combined<-rbind(combined_choices,combined_choices_3m)

all_exp_combined<-data.frame(all_exp_combined$`Treatment (Control/Experimental)`,all_exp_combined$`Ant choice`,all_exp_combined$treatment_label)

colnames(all_exp_combined)<-c("treatment","choices","exp_type")

#CONTROL TREATMENTS (1.5M VS. 3M)

#Subsetting control treatments from both experiments and comparing them using fisher's test

all_exp_combined_control<-subset(all_exp_combined,all_exp_combined$treatment=="Control")

all_exp_combined_control<-subset(all_exp_combined_control,select=-treatment)

#Converting this to table to run fisher's test
all_exp_combined_control<-table(all_exp_combined_control)

fisher.test(all_exp_combined_control)
#Non-significant

#EXPERIMENTAL TREATMENTS (1.5M VS. 3M)

#Subsetting experimental treatments from both experiments and comparing them using fisher's test

all_exp_combined_exp<-subset(all_exp_combined,all_exp_combined$treatment=="Experimental")

all_exp_combined_exp<-subset(all_exp_combined_exp,select=-treatment)

#Converting this to table to run fisher's test
all_exp_combined_exp<-table(all_exp_combined_exp)

fisher.test(all_exp_combined_exp)
#Non-significant

```

Comparing abandonment across 1.5M and 3M treatments

```{r}
combined_abandonment<-rbind(fall_2022_1.5m,fall_2023_1.5m,fall_2024_1.5m)

combined_abandonment_3m<-rbind(fall_2023_3m,fall_2024_3m)

#Creating a new column with the treatment and experiment label
combined_abandonment$treatment_label<-ifelse(combined_abandonment$`Treatment (Control/Experimental)`=="Control","Control_1.5m","Exp_1.5m")

combined_abandonment_3m$treatment_label<-ifelse(combined_abandonment_3m$`Treatment (Control/Experimental)`=="Control","Control_3m","Exp_3m")

all_exp_combined_abandonment<-rbind(combined_abandonment,combined_abandonment_3m)

all_exp_combined_abandonment<-data.frame(all_exp_combined_abandonment$`Treatment (Control/Experimental)`,all_exp_combined_abandonment$abandonment,all_exp_combined_abandonment$treatment_label)

colnames(all_exp_combined_abandonment)<-c("treatment","abandonment","exp_type")

#CONTROL TREATMENTS (1.5M VS. 3M)

#Subsetting control treatments from both experiments and comparing them using fisher's test

all_exp_combined_control_abandonment  <-subset(all_exp_combined_abandonment,all_exp_combined_abandonment$treatment=="Control")

all_exp_combined_control_abandonment<-subset(all_exp_combined_control_abandonment,select=-treatment)

#Converting this to table to run fisher's test  
all_exp_combined_control_abandonment<-table(all_exp_combined_control_abandonment)

fisher.test(all_exp_combined_control_abandonment)
#Non-significant

#EXPERIMENTAL TREATMENTS (1.5M VS. 3M)

#Subsetting experimental treatments from both experiments and comparing them using fisher's test

all_exp_combined_exp_abandonment<-subset(all_exp_combined_abandonment,all_exp_combined_abandonment$treatment=="Experimental")

all_exp_combined_exp_abandonment<-subset(all_exp_combined_exp_abandonment,select=-treatment)

#Converting this to table to run fisher's test
all_exp_combined_exp_abandonment<-table(all_exp_combined_exp_abandonment)

fisher.test(all_exp_combined_exp_abandonment)
#Significant!! This indicates that higher surcose concentration significantly decreases the abandonment! Although it does not improve the ability of ants to make more correct choices!


```


EDIT THIS CODE FOR GASTER ANGLE!!!!!


Importing data from analysis ready datasheets in the google drive for the videos that were analyzed to get the average gaster angle for each trial.

Converting relevant columns to factors and numbers

Fall 2022 data
```{r}

fall_2022_data<-read_sheet("https://docs.google.com/spreadsheets/d/1FPRGuBRdiHnLm_N69nAY1XQ4KUyYbEUaDxLwup3Zw-8/edit#gid=0")
fall_2022_data<-as.data.frame(fall_2022_data)
fall_2022_data$`Location of the ant`<-as.factor(fall_2022_data$`Location of the ant`)
fall_2022_data$`Ant choice`<-as.factor(fall_2022_data$`Ant choice`)
fall_2022_data$Treatment<-as.factor(fall_2022_data$Treatment)
fall_2022_data$Video<-as.factor(fall_2022_data$Video)
fall_2022_data$`Angle measurement 1`<-as.numeric(fall_2022_data$`Angle measurement 1`)
fall_2022_data$`Angle measurement 2`<-as.numeric(fall_2022_data$`Angle measurement 2`)
fall_2022_data$`Angle measurement 3`<-as.numeric(fall_2022_data$`Angle measurement 3`)

#Ignore the warnings here
```


Gaster angle analysis only done for fall 2022 data, so these following steps are needed before analysis

Subsetting zone 1 data (area on the setup where the perturbation was introduced). Then it is followed by taking average for a given frame, and then averaging over all the frames for a given video to get the final usuable datasheet.

```{r}
zone1_data<-subset(fall_2022_data,fall_2022_data$`Location of the ant`=="Zone1")
zone1_data$`Gaster touching the paper`<-as.factor(zone1_data$`Gaster touching the paper`)

zone1_data_modified<-zone1_data %>%
  transmute(Video,Treatment,`Ant choice`,mean_gaster_angle=rowMeans(select(.,`Angle measurement 1`:`Angle measurement 3`)))

zone1_modified_byvideo<-zone1_data_modified %>%
  group_by(Video,Treatment,`Ant choice`) %>%
  summarise(mean_gaster_angle=mean(mean_gaster_angle,na.rm = T))
zone1_modified_byvideo<-as.data.frame(zone1_modified_byvideo)

#This dataframe contains gaster angle and all the choices including abandonment 
fall_2022_data<-zone1_modified_byvideo

#New dataframe to store the Treatment and choices data only(without abandonment data)
fall_2022_data_choices<-data.frame(fall_2022_data$Treatment,fall_2022_data$`Ant choice`)

fall_2022_data_choices<-subset(fall_2022_data_choices,fall_2022_data_choices$fall_2022_data..Ant.choice.!="Abandoned")

colnames(fall_2022_data_choices)<-c("treatment","choices")

```

Fall 2023 data

Analyzing gaster angles

I'm only analyzing gaster angle data for the ants that made a correct choices across both the treatments
```{r}
#Fall 2022 data

fall_2022_data_gaster<-as.data.frame(subset(fall_2022_data,fall_2022_data$`Ant choice`=="Correct"))

fall_2022_data_gaster %>%
  group_by(Treatment) %>%
  summarise(mean_gaster_angle=mean(mean_gaster_angle))

wilcox.test(fall_2022_data_gaster$mean_gaster_angle~fall_2022_data_gaster$Treatment)

#boxplot of choices
boxplot(fall_2022_data_gaster$mean_gaster_angle~fall_2022_data_gaster$Treatment,xlab="Treatment", ylab="Mean gaster angle (degrees)",main="Mean gaster angles for perturbed vs. unperturbed experiments",range=0)


#Fall 2023 data

fall_2023_data_gaster<-read_sheet("https://docs.google.com/spreadsheets/d/17etkrXmeS3bdT7omTB1WCpzjvrimKpTp73nBw-TwXyY/edit?gid=0#gid=0")
fall_2023_data_gaster<-as.data.frame(fall_2023_data_gaster)
fall_2023_data_gaster$`Ant choice`<-as.factor(fall_2023_data_gaster$`Ant choice`)
fall_2023_data_gaster$Treatment<-as.factor(fall_2023_data_gaster$Treatment)
fall_2023_data_gaster$Video<-as.factor(fall_2023_data_gaster$Video)
fall_2023_data_gaster$`Angle measurement 1`<-as.numeric(fall_2023_data_gaster$`Angle measurement 1`)
fall_2023_data_gaster$`Angle measurement 2`<-as.numeric(fall_2023_data_gaster$`Angle measurement 2`)
fall_2023_data_gaster$`Angle measurement 3`<-as.numeric(fall_2023_data_gaster$`Angle measurement 3`)
#Ignore the warnings here

#Averaging the three gaster angle measurements for a given frame
fall_2023_data_gaster_modified<-fall_2023_data_gaster %>%
  transmute(Video,Treatment,`Ant choice`,mean_gaster_angle=rowMeans(select(.,`Angle measurement 1`:`Angle measurement 3`)))

#Averaging gaster angles over all the frames for a given video
fall_2023_data_gaster_modified<-fall_2023_data_gaster_modified %>%
  group_by(Video,Treatment,`Ant choice`) %>%
  summarise(mean_gaster_angle=mean(mean_gaster_angle,na.rm = T))

fall_2023_data_gaster_modified<-as.data.frame(fall_2023_data_gaster_modified)

#Subsetting gaster angles for only correct choices and only for control
fall_2023_data_gaster_modified<-as.data.frame(subset(fall_2023_data_gaster_modified,fall_2023_data_gaster_modified$`Ant choice`=="Correct"))


#Combining fall 2022 and fall 2023 gaster angle data

combined_gaster_angle<-rbind(fall_2022_data_gaster,fall_2023_data_gaster_modified)

wilcox.test(combined_gaster_angle$mean_gaster_angle~combined_gaster_angle$Treatment)

#boxplot of choices
boxplot(combined_gaster_angle$mean_gaster_angle~combined_gaster_angle$Treatment,xlab="Treatment", ylab="Mean gaster angle (degrees)",main="Mean gaster angles for perturbed vs. unperturbed experiments",range=0)
 


```



Other analyses done on the data


Subsetting data experimental and control data and then testing if the gaster angles are significantly difference within the treatments for the ants that made a choice vs. the ants that abandoned.
```{r}

experimental<-subset(zone1_modified_byvideo,zone1_modified_byvideo$Treatment=="Experimental")

experimental_abandoned<-subset(experimental,Ant.choice=="Abandoned")
experimental_choice<-subset(experimental,Ant.choice!="Abandoned")
experimental_correct_choice<-subset(experimental_choice,Ant.choice=="Correct")
experimental_wrong_choice<-subset(experimental_choice,Ant.choice!="Correct")


t.test(experimental_abandoned$mean_gaster_angle,experimental_choice$mean_gaster_angle)

t.test(experimental_correct_choice$mean_gaster_angle,experimental_abandoned$mean_gaster_angle)

t.test(experimental_correct_choice$mean_gaster_angle,experimental_wrong_choice$mean_gaster_angle)


#Gaster angles of ant that abandoned and that made a choice is not significantly different. Same goes with the correct choice vs. abandoned, and correct vs. wrong choice. 

control<-subset(zone1_modified_byvideo,zone1_modified_byvideo$Treatment=="Control")

control_abandoned<-subset(control,Ant.choice=="Abandoned")
control_choice<-subset(control,Ant.choice!="Abandoned")
control_correct_choice<-subset(control_choice,Ant.choice=="Correct")
control_wrong_choice<-subset(control_choice,Ant.choice!="Correct")

t.test(control_correct_choice$mean_gaster_angle,control_wrong_choice$mean_gaster_angle)

#Variance test between the treatments for the ants that made a choice
var.test(experimental_choice$mean_gaster_angle, control_choice$mean_gaster_angle)


#Gaster angles between correct and wrong choices are not significantly different from each other for the control
```

Running t-test on average gaster angle for control vs. experimental data for ants that made a correct choice vs. the ants that 
```{r}
t.test(control_correct_choice$mean_gaster_angle,experimental_correct_choice$mean_gaster_angle)

```



Average gaster angle data was combined for ants that went to food vs. the ants that either abandoned or went to wrong arm (both treatments combined). Also another subsetting was done to compare gaster angles between ants that abandoned and ants that made a correct choice (both treatments combined)
```{r}

combined_choice<-subset(zone1_modified_byvideo,zone1_modified_byvideo$Ant.choice=="Correct")
combined_no_choice<-subset(zone1_modified_byvideo,zone1_modified_byvideo$Ant.choice!="Correct")
combined_abandoned<-subset(zone1_modified_byvideo,zone1_modified_byvideo$Ant.choice=="Abandoned")
combined_wrong_choice<-subset(zone1_modified_byvideo,zone1_modified_byvideo$Ant.choice=="Wrong")

t.test(combined_choice$mean_gaster_angle,combined_no_choice$mean_gaster_angle)
t.test(combined_choice$mean_gaster_angle,combined_abandoned$mean_gaster_angle)
t.test(combined_choice$mean_gaster_angle,combined_wrong_choice$mean_gaster_angle)

#No significant difference found in the average gaster angle.

```

Boxplots
```{r}

boxplot(zone1_modified_byvideo$mean_gaster_angle~zone1_modified_byvideo$exp,xlab = "Choices made by ant", ylab = "Mean gaster angles")

boxplot(experimental$mean_gaster_angle~experimental$exp,xlab = "Choices made by ant", ylab = "Mean gaster angles")

boxplot(control$mean_gaster_angle~control$exp,xlab = "Choices made by ant", ylab = "Mean gaster angles")


boxplot(zone1_modified_byvideo$mean_gaster_angle~zone1_modified_byvideo$Treatment,xlab="Group", ylab="Mean gaster angle (degrees)",main="Mean gaster angles for perturbed vs. unperturbed experiments",range=0)
par(cex.lab=1,cex.axis=1)


data_1<-subset(zone1_modified_byvideo,zone1_modified_byvideo$exp!="Abandoned")

boxplot(data_1$mean_gaster_angle~data_1$Treatment,xlab="Treatment", ylab="Mean gaster angle (degrees)",main="Mean gaster angles for perturbed vs. unperturbed experiments",range=0)
par(cex.lab=1,cex.axis=1)


```


Analysis related to gaster touching the paper
Steps:
1. Count number of times gaster touched the paper for every video
2. Then compare that with experimental and control (overall)
```{r}
zone1_modified_2<-zone1_data %>%
  group_by(Gaster.touching.the.paper,Treatment) %>%
  summarise(n=n())
zone1_modified_2<-as.data.frame(zone1_modified_2)

experimental_1<-subset(zone1_modified_2,zone1_modified_2$Treatment=="experimental")
control_1<-subset(zone1_modified_2,zone1_modified_2$Treatment=="Control")
barplot(experimental_1$n~experimental_1$Gaster.touching.the.paper,xlab="Gaster touching the paper", ylab="Frequency",main="Frequency of gaster touching the paper in experimental")
barplot(control_1$n~control_1$Gaster.touching.the.paper,xlab="Gaster touching the paper", ylab="Frequency",main="Frequency of gaster touching the paper in control")

gaster_touching_data<-subset(zone1_modified_2,zone1_modified_2$Gaster.touching.the.paper=="Yes")

gaster_touching_data$n<-c(0.081,0.078)

#Barplot of gaster touching frequency/proportion between experimental and control
barplot(gaster_touching_data$n~gaster_touching_data$Treatment,xlab="Groups",ylab="Proportion of times gaster touched the paper surface")

#Running Fisher's exact test on the proportions

gaster_data<-as.table(cbind(c(5,5),c(57,64)))
dimnames(gaster_data)<-list(exp_type=c("control","experimental"),gaster_touched=c("yes","no"))
  data.frame(
  "Yes"= c(5,5),
  "No"= c(57,64),row.names=c("control","experimental"))

fisher.test(gaster_data)

#No significant difference between gaster touched and not touched in experimental vs. control

```



