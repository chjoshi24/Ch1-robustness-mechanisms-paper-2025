#Filtering ant choices and treatment for fisher's test and binomial test
combined_choices<-data.frame(combined_choices$`Treatment (Control/Experimental)`,combined_choices$`Ant choice`)
colnames(combined_choices)<-c("treatment","choice")
#Converting this data into a table
combined_choices<-table(combined_choices)
combined_choices_plot<-data.frame(combined_choices)
combined_choices_plot
ggplot(combined_choices_plot,aes(Freq))+geom_bar(aes(fill=choice))
ggplot(combined_choices_plot,aes(treatment,Freq))+geom_bar(aes(fill=choice))
mpg
as.data.frame(mpg)
#Boxplots of choices
combined_choices_plot<-rbind(fall_2022_1.5m_choices,fall_2023_1.5m_choices,fall_2024_1.5m_choices)
#Boxplots of choices
combined_choices_plot<-rbind(fall_2022_1.5m_choices,fall_2023_1.5m_choices,fall_2024_1.5m_choices)
combined_choices_plot<-data.frame(combined_choices_plot$`Treatment (Control/Experimental)`,combined_choices_plot$`Ant choice`)
colnames(combined_choices_plot)<-c("treatment","choice")
combined_choices_plot
ggplot(combined_choices_plot,aes(choice))+geom_bar()
ggplot(combined_choices_plot,aes(choice))+geom_bar(aes(fill=treatment))
ggplot(combined_choices_plot,aes(treatment))+geom_bar(aes(fill=choice))
remove(combined_choices_plot)
#Combining all the dataframes with ant choices across three seasons
combined_choices<-rbind(fall_2022_1.5m_choices,fall_2023_1.5m_choices,fall_2024_1.5m_choices)
#Filtering ant choices and treatment for fisher's test and binomial test
combined_choices<-data.frame(combined_choices$`Treatment (Control/Experimental)`,combined_choices$`Ant choice`)
colnames(combined_choices)<-c("treatment","choice")
ggplot(combined_choices,aes(treatment))+geom_bar(aes(fill=choice))
ggplot(combined_choices,aes(treatment))+geom_bar(aes(fill=choice))+ xlab("Treatment")+ylab("Total number of choices")
ggplot(combined_choices,aes(treatment))+geom_bar(aes(fill=choice))+ xlab("Treatment")+ylab("Total number of choices")+ggtitle("1.5M experiment choice data")
ggplot(combined_choices,aes(treatment))+geom_bar(aes(fill=choice))+ xlab("Treatment")+ylab("Total number of choices")+ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=5))
ggplot(combined_choices,aes(treatment))+geom_bar(aes(fill=choice))+ xlab("Treatment")+ylab("Total number of choices")+ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=20))
ggplot(combined_choices,aes(treatment))+geom_bar(aes(fill=choice))+ xlab("Treatment")+ylab("Total number of choices")+ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=5),axis.title.x = element_text(size=10))
ggplot(combined_choices,aes(treatment))+geom_bar(aes(fill=choice))+ xlab("Treatment")+ylab("Total number of choices")+ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=20),axis.title.x = element_text(size=10))
ggplot(combined_choices,aes(treatment))+geom_bar(aes(fill=choice))+ xlab("Treatment")+ylab("Total number of choices")+ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=20))
fall_2022_1.5m$abandonment<-ifelse(fall_2022_1.5m$`Ant choice`=="Abandoned","Abandoned","On-trail")
fall_2023_1.5m$abandonment<-ifelse(fall_2023_1.5m$`Ant choice`=="Abandoned","Abandoned","On-trail")
fall_2024_1.5m$abandonment<-ifelse(fall_2024_1.5m$`Ant choice`=="Abandoned","Abandoned","On-trail")
#Combining all the dataframes
combined_abandonment<-rbind(fall_2022_1.5m,fall_2023_1.5m,fall_2024_1.5m)
combined_abandonment<-data.frame(combined_abandonment$`Treatment (Control/Experimental)`,combined_abandonment$abandonment)
colnames(combined_abandonment)<-c("treatment","abandonment")
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=choice))
combined_abandonment
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=20))
#Fall 2023
fall_2023_3m_choices<-fall_2023_3m %>%
filter(`Ant choice`!="Abandoned")
fall_2023_3m_choices$`Ant choice`<-droplevels(fall_2023_3m_choices$`Ant choice`)
fall_2023_3m_choices$`Ant choice`<-ifelse(fall_2023_3m_choices$`Ant choice`==fall_2023_3m_choices$`Side/arm of feeder`,"Correct","Wrong")
#Fall 2024
fall_2024_3m_choices<-fall_2024_3m %>%
filter(`Ant choice`!="Abandoned")
fall_2024_3m_choices$`Ant choice`<-droplevels(fall_2024_3m_choices$`Ant choice`)
fall_2024_3m_choices$`Ant choice`<-ifelse(fall_2024_3m_choices$`Ant choice`==fall_2024_3m_choices$`Side/arm of feeder`,"Correct","Wrong")
combined_choices_3m<-rbind(fall_2023_3m_choices,fall_2024_3m_choices)
combined_choices_3m<-data.frame(combined_choices_3m$`Treatment (Control/Experimental)`,combined_choices_3m$`Ant choice`)
colnames(combined_choices_3m)<-c("treatment","choice")
ggplot(combined_choices_3m,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("3M experiment choice data")+ theme(text=element_text(size=20))
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=20))
ggplot(combined_choices_3m,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("3M experiment choice data")+ theme(text=element_text(size=20))
#Boxplots of choices
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=20))
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=20),axis.text = element_text(size=20))
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=20),axis.text = element_text(size=20))
ggplot(combined_choices_3m,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("3M experiment choice data")+ theme(text=element_text(size=20),axis.text = element_text(size=20))
ggplot(combined_choices_3m,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("3M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))
fall_2023_3m$abandonment<-ifelse(fall_2023_3m$`Ant choice`=="Abandoned","Abandoned","On-trail")
fall_2024_3m$abandonment<-ifelse(fall_2024_3m$`Ant choice`=="Abandoned","Abandoned","On-trail")
#Combining all the dataframes
combined_abandonment_3m<-rbind(fall_2023_3m,fall_2024_3m)
combined_abandonment_3m<-data.frame(combined_abandonment_3m$`Treatment (Control/Experimental)`,combined_abandonment_3m$abandonment)
colnames(combined_abandonment_3m)<-c("treatment","abandonment")
ggplot(combined_abandonment_3m,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("3M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))
combined_abandonment_comparison<-rbind(fall_2022_1.5m,fall_2023_1.5m,fall_2024_1.5m)
combined_abandonment_comparison_3m<-rbind(fall_2023_3m,fall_2024_3m)
#Creating a new column with the treatment and experiment label
combined_abandonment_comparison$treatment_label<-ifelse(combined_abandonment_comparison$`Treatment (Control/Experimental)`=="Control","Control_1.5m","Exp_1.5m")
combined_abandonment_comparison_3m$treatment_label<-ifelse(combined_abandonment_comparison_3m$`Treatment (Control/Experimental)`=="Control","Control_3m","Exp_3m")
all_exp_combined_abandonment<-rbind(combined_abandonment_comparison,combined_abandonment_comparison_3m)
all_exp_combined_abandonment<-data.frame(all_exp_combined_abandonment$`Treatment (Control/Experimental)`,all_exp_combined_abandonment$abandonment,all_exp_combined_abandonment$treatment_label)
colnames(all_exp_combined_abandonment)<-c("treatment","abandonment","exp_type")
all_exp_combined_control_abandonment  <-subset(all_exp_combined_abandonment,all_exp_combined_abandonment$treatment=="Control")
all_exp_combined_control_abandonment<-subset(all_exp_combined_control_abandonment,select=-treatment)
all_exp_combined_control_abandonment
ggplot(all_exp_combined_control,aes(exp_type))+
geom_bar(aes(fill=abandonment))
ggplot(all_exp_combined_control_abandonment,aes(exp_type))+
geom_bar(aes(fill=abandonment))
ggplot(all_exp_combined_control_abandonment,aes(exp_type))+
geom_bar(aes(fill=abandonment))+
xlab("Experiment")+
ylab("Total ants abandoned")+
ggtitle("Control treatment 1.5M vs. 3M")+ theme(text=element_text(size=30),axis.text = element_text(size=20))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(googlesheets4)
library(ggplot2)
#Importing 1.5M data from two seasons and doing the necessary transformations in the data
fall_2022_1.5m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1VCywNjZ6dYYV7aQSDPEoWkZnwZupzepO-hj_dxjA9II/edit?gid=0#gid=0"))
fall_2023_1.5m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1UvuY_wv78jGxdG5KQwZlSYvwqsPIHxr0fkeslZk4AkM/edit?gid=0#gid=0",sheet="Data_1.5M sucrose"))
fall_2024_1.5m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1lPkGkT4vRmqpSdu5HWjKZL-jaAVoRs118nmB2sqmHtI/edit?gid=0#gid=0",sheet="1.5 M data"))
#Filtering the columns that are needed for the choice and abandonment analyses
fall_2022_1.5m<-fall_2022_1.5m[1:8]
fall_2023_1.5m<-fall_2023_1.5m[1:8]
fall_2024_1.5m<-fall_2024_1.5m[1:8]
#Converting character columns into factors
fall_2022_1.5m<-fall_2022_1.5m %>%
mutate_if(is.character,as.factor)
fall_2023_1.5m<-fall_2023_1.5m %>%
mutate_if(is.character,as.factor)
fall_2024_1.5m<-fall_2024_1.5m %>%
mutate_if(is.character,as.factor)
#Importing 3M data from two seasons
fall_2023_3m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1UvuY_wv78jGxdG5KQwZlSYvwqsPIHxr0fkeslZk4AkM/edit?gid=0#gid=0",sheet="Data_3M sucrose"))
fall_2024_3m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1lPkGkT4vRmqpSdu5HWjKZL-jaAVoRs118nmB2sqmHtI/edit?gid=0#gid=0",sheet="3M data"))
#Filtering the columns that are needed for the choice and abandonment analyses
fall_2023_3m<-fall_2023_3m[1:8]
fall_2024_3m<-fall_2024_3m[1:8]
#Converting character columns into factors
fall_2023_3m<-fall_2023_3m %>%
mutate_if(is.character,as.factor)
fall_2024_3m<-fall_2024_3m %>%
mutate_if(is.character,as.factor)
fall_2022_gaster_angle<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1FPRGuBRdiHnLm_N69nAY1XQ4KUyYbEUaDxLwup3Zw-8/edit#gid=0"))
fall_2022_gaster_angle$`Location of the ant`<-as.factor(fall_2022_gaster_angle$`Location of the ant`)
fall_2022_gaster_angle$`Ant choice`<-as.factor(fall_2022_gaster_angle$`Ant choice`)
fall_2022_gaster_angle$Treatment<-as.factor(fall_2022_gaster_angle$Treatment)
fall_2022_gaster_angle$Video<-as.factor(fall_2022_gaster_angle$Video)
fall_2022_gaster_angle$`Angle measurement 1`<-as.numeric(fall_2022_gaster_angle$`Angle measurement 1`)
fall_2022_gaster_angle$`Angle measurement 2`<-as.numeric(fall_2022_gaster_angle$`Angle measurement 2`)
fall_2022_gaster_angle$`Angle measurement 3`<-as.numeric(fall_2022_gaster_angle$`Angle measurement 3`)
#Ignore the warnings here
#Fall 2022
fall_2022_1.5m_choices<-fall_2022_1.5m %>%
filter(`Ant choice`!="Abandoned")
fall_2022_1.5m_choices$`Ant choice`<-droplevels(fall_2022_1.5m_choices$`Ant choice`)
fall_2022_1.5m_choices$`Ant choice`<-ifelse(fall_2022_1.5m_choices$`Ant choice`==fall_2022_1.5m_choices$`Side/arm of feeder`,"Correct","Wrong")
#Fall 2023
fall_2023_1.5m_choices<-fall_2023_1.5m %>%
filter(`Ant choice`!="Abandoned")
fall_2023_1.5m_choices$`Ant choice`<-droplevels(fall_2023_1.5m_choices$`Ant choice`)
fall_2023_1.5m_choices$`Ant choice`<-ifelse(fall_2023_1.5m_choices$`Ant choice`==fall_2023_1.5m_choices$`Side/arm of feeder`,"Correct","Wrong")
#Fall 2024
fall_2024_1.5m_choices<-fall_2024_1.5m %>%
filter(`Ant choice`!="Abandoned")
fall_2024_1.5m_choices$`Ant choice`<-droplevels(fall_2024_1.5m_choices$`Ant choice`)
fall_2024_1.5m_choices$`Ant choice`<-ifelse(fall_2024_1.5m_choices$`Ant choice`==fall_2024_1.5m_choices$`Side/arm of feeder`,"Correct","Wrong")
#Combining all the dataframes with ant choices across three seasons
combined_choices<-rbind(fall_2022_1.5m_choices,fall_2023_1.5m_choices,fall_2024_1.5m_choices)
#Filtering ant choices and treatment for fisher's test and binomial test
combined_choices<-data.frame(combined_choices$`Treatment (Control/Experimental)`,combined_choices$`Ant choice`)
colnames(combined_choices)<-c("treatment","choice")
#Boxplots of choices
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))
#Converting this data into a table
combined_choices<-table(combined_choices)
fisher.test(combined_choices)
chisq.test(combined_choices,correct = F)
#Significant!
#Binomial test for control data
binom.test(23,27,0.5)
#Significant!
#Binomial test for experimental data
binom.test(4,12,0.5)
#Non-significant
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+scale_color_brewer(palette = "BrBG")
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+scale_fill_viridis_c()
library(ggthemes)
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+
scale_fill_colorblind()
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+
scale_fill_colorblind()
#Fall 2022
fall_2022_1.5m_choices<-fall_2022_1.5m %>%
filter(`Ant choice`!="Abandoned")
fall_2022_1.5m_choices$`Ant choice`<-droplevels(fall_2022_1.5m_choices$`Ant choice`)
fall_2022_1.5m_choices$`Ant choice`<-ifelse(fall_2022_1.5m_choices$`Ant choice`==fall_2022_1.5m_choices$`Side/arm of feeder`,"Correct","Wrong")
#Fall 2023
fall_2023_1.5m_choices<-fall_2023_1.5m %>%
filter(`Ant choice`!="Abandoned")
fall_2023_1.5m_choices$`Ant choice`<-droplevels(fall_2023_1.5m_choices$`Ant choice`)
fall_2023_1.5m_choices$`Ant choice`<-ifelse(fall_2023_1.5m_choices$`Ant choice`==fall_2023_1.5m_choices$`Side/arm of feeder`,"Correct","Wrong")
#Fall 2024
fall_2024_1.5m_choices<-fall_2024_1.5m %>%
filter(`Ant choice`!="Abandoned")
fall_2024_1.5m_choices$`Ant choice`<-droplevels(fall_2024_1.5m_choices$`Ant choice`)
fall_2024_1.5m_choices$`Ant choice`<-ifelse(fall_2024_1.5m_choices$`Ant choice`==fall_2024_1.5m_choices$`Side/arm of feeder`,"Correct","Wrong")
#Combining all the dataframes with ant choices across three seasons
combined_choices<-rbind(fall_2022_1.5m_choices,fall_2023_1.5m_choices,fall_2024_1.5m_choices)
#Filtering ant choices and treatment for fisher's test and binomial test
combined_choices<-data.frame(combined_choices$`Treatment (Control/Experimental)`,combined_choices$`Ant choice`)
colnames(combined_choices)<-c("treatment","choice")
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+
scale_fill_colorblind()
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+
scale_fill_brewer()
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+
scale_fill_fermenter()
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+
scale_fill_colorblind()
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+
scale_fill_colorblind7()
fall_2022_1.5m$abandonment<-ifelse(fall_2022_1.5m$`Ant choice`=="Abandoned","Abandoned","On-trail")
fall_2023_1.5m$abandonment<-ifelse(fall_2023_1.5m$`Ant choice`=="Abandoned","Abandoned","On-trail")
fall_2024_1.5m$abandonment<-ifelse(fall_2024_1.5m$`Ant choice`=="Abandoned","Abandoned","On-trail")
#Combining all the dataframes
combined_abandonment<-rbind(fall_2022_1.5m,fall_2023_1.5m,fall_2024_1.5m)
combined_abandonment<-data.frame(combined_abandonment$`Treatment (Control/Experimental)`,combined_abandonment$abandonment)
colnames(combined_abandonment)<-c("treatment","abandonment")
#Boxplot of abandonment
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_fill_colorblind()
install.packages("dichromat")
dichromat::colorschemes
library(dichromat)
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+
scale_fill_manual(values=dichromat(grey2))
?dichromat
dichromat::colorschemes
colorschemes$BrowntoBlue.10
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+
scale_fill_manual(colorblind_pal())
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+
scale_fill_manual(colorschemes$BrowntoBlue.10)
library(viridis)
detach(dichromat())
detach(dichromat
)
detach("package:dichromat", unload = TRUE)
library(viridis)
#Boxplot of abandonment
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_fill_viridis()
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_color_viridis_b()
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_color_viridis()
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_fill_viridis()
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_color_viridis()
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_fill_viridis_d()
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_fill_viridis_c()
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_color_viridis_b()
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_color_viridis()
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_color_viridis_c()
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_color_viridis_d()
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_fill_viridis_d()
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_color_colorblind()
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_color_colorblind()
ggplot(combined_abandonment,aes(treatment))+
geom_bar(aes(fill=abandonment))+
xlab("Treatment")+
ylab("Total number of abandonments")+
ggtitle("1.5M experiment abandonment data")+ theme(text=element_text(size=25),axis.text = element_text(size=20))+scale_color_colorblind()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidyverse)
library(googlesheets4)
library(ggplot2)
filter()
filter
library(tidyverse)
library(googlesheets4)
library(ggplot2)
library(viridis)
#Importing 1.5M data from two seasons and doing the necessary transformations in the data
fall_2022_1.5m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1VCywNjZ6dYYV7aQSDPEoWkZnwZupzepO-hj_dxjA9II/edit?gid=0#gid=0"))
fall_2023_1.5m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1UvuY_wv78jGxdG5KQwZlSYvwqsPIHxr0fkeslZk4AkM/edit?gid=0#gid=0",sheet="Data_1.5M sucrose"))
fall_2024_1.5m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1lPkGkT4vRmqpSdu5HWjKZL-jaAVoRs118nmB2sqmHtI/edit?gid=0#gid=0",sheet="1.5 M data"))
#Filtering the columns that are needed for the choice and abandonment analyses
fall_2022_1.5m<-fall_2022_1.5m[1:8]
fall_2023_1.5m<-fall_2023_1.5m[1:8]
fall_2024_1.5m<-fall_2024_1.5m[1:8]
#Converting character columns into factors
fall_2022_1.5m<-fall_2022_1.5m %>%
mutate_if(is.character,as.factor)
fall_2023_1.5m<-fall_2023_1.5m %>%
mutate_if(is.character,as.factor)
fall_2024_1.5m<-fall_2024_1.5m %>%
mutate_if(is.character,as.factor)
#Importing 3M data from two seasons
fall_2023_3m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1UvuY_wv78jGxdG5KQwZlSYvwqsPIHxr0fkeslZk4AkM/edit?gid=0#gid=0",sheet="Data_3M sucrose"))
fall_2024_3m<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1lPkGkT4vRmqpSdu5HWjKZL-jaAVoRs118nmB2sqmHtI/edit?gid=0#gid=0",sheet="3M data"))
#Filtering the columns that are needed for the choice and abandonment analyses
fall_2023_3m<-fall_2023_3m[1:8]
fall_2024_3m<-fall_2024_3m[1:8]
#Converting character columns into factors
fall_2023_3m<-fall_2023_3m %>%
mutate_if(is.character,as.factor)
fall_2024_3m<-fall_2024_3m %>%
mutate_if(is.character,as.factor)
fall_2022_gaster_angle<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1FPRGuBRdiHnLm_N69nAY1XQ4KUyYbEUaDxLwup3Zw-8/edit#gid=0"))
fall_2022_gaster_angle$`Location of the ant`<-as.factor(fall_2022_gaster_angle$`Location of the ant`)
fall_2022_gaster_angle$`Ant choice`<-as.factor(fall_2022_gaster_angle$`Ant choice`)
fall_2022_gaster_angle$Treatment<-as.factor(fall_2022_gaster_angle$Treatment)
fall_2022_gaster_angle$Video<-as.factor(fall_2022_gaster_angle$Video)
fall_2022_gaster_angle$`Angle measurement 1`<-as.numeric(fall_2022_gaster_angle$`Angle measurement 1`)
fall_2022_gaster_angle$`Angle measurement 2`<-as.numeric(fall_2022_gaster_angle$`Angle measurement 2`)
fall_2022_gaster_angle$`Angle measurement 3`<-as.numeric(fall_2022_gaster_angle$`Angle measurement 3`)
#Ignore the warnings here
#Fall 2022
fall_2022_1.5m_choices<-fall_2022_1.5m %>%
filter(`Ant choice`!="Abandoned")
fall_2022_1.5m_choices$`Ant choice`<-droplevels(fall_2022_1.5m_choices$`Ant choice`)
fall_2022_1.5m_choices$`Ant choice`<-ifelse(fall_2022_1.5m_choices$`Ant choice`==fall_2022_1.5m_choices$`Side/arm of feeder`,"Correct","Wrong")
#Fall 2023
fall_2023_1.5m_choices<-fall_2023_1.5m %>%
filter(`Ant choice`!="Abandoned")
fall_2023_1.5m_choices$`Ant choice`<-droplevels(fall_2023_1.5m_choices$`Ant choice`)
fall_2023_1.5m_choices$`Ant choice`<-ifelse(fall_2023_1.5m_choices$`Ant choice`==fall_2023_1.5m_choices$`Side/arm of feeder`,"Correct","Wrong")
#Fall 2024
fall_2024_1.5m_choices<-fall_2024_1.5m %>%
filter(`Ant choice`!="Abandoned")
fall_2024_1.5m_choices$`Ant choice`<-droplevels(fall_2024_1.5m_choices$`Ant choice`)
fall_2024_1.5m_choices$`Ant choice`<-ifelse(fall_2024_1.5m_choices$`Ant choice`==fall_2024_1.5m_choices$`Side/arm of feeder`,"Correct","Wrong")
#Combining all the dataframes with ant choices across three seasons
combined_choices<-rbind(fall_2022_1.5m_choices,fall_2023_1.5m_choices,fall_2024_1.5m_choices)
#Filtering ant choices and treatment for fisher's test and binomial test
combined_choices<-data.frame(combined_choices$`Treatment (Control/Experimental)`,combined_choices$`Ant choice`)
colnames(combined_choices)<-c("treatment","choice")
#Boxplots of choices
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+
scale_fill_colorblind()
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+
scale_fill_colorblind()
library(ggthemes)
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+
scale_fill_colorblind()
ggplot(combined_choices,aes(treatment))+
geom_bar(aes(fill=choice))+
xlab("Treatment")+
ylab("Total number of choices")+
ggtitle("1.5M experiment choice data")+ theme(text=element_text(size=30),axis.text = element_text(size=20))+
scale_color_colorblind()
