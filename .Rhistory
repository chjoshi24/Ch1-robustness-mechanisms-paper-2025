knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(dplyr)
library(googlesheets4)
fall_2022_data<-read_sheet("https://docs.google.com/spreadsheets/d/1FPRGuBRdiHnLm_N69nAY1XQ4KUyYbEUaDxLwup3Zw-8/edit#gid=0")
fall_2022_data<-as.data.frame(fall_2022_data)
fall_2022_data$`Location of the ant`<-as.factor(fall_2022_data$`Location of the ant`)
fall_2022_data$`Ant choice`<-as.factor(fall_2022_data$`Ant choice`)
fall_2022_data$Treatment<-as.factor(fall_2022_data$Treatment)
fall_2022_data$Video<-as.factor(fall_2022_data$Video)
fall_2022_data$`Angle measurement 1`<-as.numeric(fall_2022_data$`Angle measurement 1`)
fall_2022_data$`Angle measurement 2`<-as.numeric(fall_2022_data$`Angle measurement 2`)
fall_2022_data$`Angle measurement 3`<-as.numeric(fall_2022_data$`Angle measurement 3`)
zone1_data<-subset(fall_2022_data,fall_2022_data$`Location of the ant`=="Zone1")
zone1_data$`Gaster touching the paper`<-as.factor(zone1_data$`Gaster touching the paper`)
zone1_data_modified<-zone1_data %>%
transmute(Video,Treatment,`Ant choice`,mean_gaster_angle=rowMeans(select(.,`Angle measurement 1`:`Angle measurement 3`)))
zone1_modified_byvideo<-zone1_data_modified %>%
group_by(Video,Treatment,`Ant choice`) %>%
summarise(mean_gaster_angle=mean(mean_gaster_angle,na.rm = T))
zone1_modified_byvideo<-as.data.frame(zone1_modified_byvideo)
#This dataframe contains gaster angle and all the choices including abandonment
fall_2022_data<-zone1_modified_byvideo
#New dataframe to store the Treatment and choices data only(without abandonment data)
fall_2022_data_choices<-data.frame(fall_2022_data$Treatment,fall_2022_data$`Ant choice`)
fall_2022_data_choices<-subset(fall_2022_data_choices,fall_2022_data_choices$fall_2022_data..Ant.choice.!="Abandoned")
colnames(fall_2022_data_choices)<-c("treatment","choices")
#To count ant choices for the given treatment (for reporting in the manuscript writing)
fall_2022_data %>%
group_by(Treatment,) %>%
count(`Ant choice`)
fall_2022_data
fall_2023_data<-read_sheet("https://docs.google.com/spreadsheets/d/1UvuY_wv78jGxdG5KQwZlSYvwqsPIHxr0fkeslZk4AkM/edit#gid=0")
fall_2023_data<-as.data.frame(fall_2023_data)
fall_2023_data$`Ant choice`<-as.factor(fall_2023_data$`Ant choice`)
fall_2023_data$`Treatment (Control/Experimental)`<-as.factor(fall_2023_data$`Treatment (Control/Experimental)`)
#To count ant choices for the given treatment (for reporting in the manuscript writing)
fall_2023_data_counting<-data.frame(fall_2023_data$`Treatment (Control/Experimental)`,fall_2023_data$`Ant choice`)
colnames(fall_2023_data_counting)<-c("treatment","choices")
fall_2023_data_counting %>%
group_by(treatment,) %>%
count(choices)
fall_2023_data_choices<-subset(fall_2023_data,fall_2023_data$`Ant choice`!="Abandoned")
fall_2023_data_choices$`Ant choice`<- ifelse(fall_2023_data_choices$`Ant choice`==fall_2023_data_choices$`Side/arm of feeder`,"Correct","Wrong")
fall_2023_data_choices<-data.frame(fall_2023_data_choices$`Treatment (Control/Experimental)`,fall_2023_data_choices$`Ant choice`)
colnames(fall_2023_data_choices)<-c("treatment","choices")
fall_2023_data_choices %>%
group_by(treatment,) %>%
count(choices)
#Combining the choices data from both seasons
combined_choices<-rbind(fall_2022_data_choices,fall_2023_data_choices)
#Removing uncessary factor levels.
combined_choices$choices<- droplevels(combined_choices$choices)
#Creating contingency table
choice_freq_table<-table(combined_choices)
choice_freq_table
combined_choices
fall_2022_data
fall_2023_data$`Ant choice`
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(dplyr)
library(googlesheets4)
fall_2023_data_choices
combined_choices
choice_freq_table
#Fall 2022 data
fall_2022_data_abandonment<-fall_2022_data
fall_2022_data_abandonment$`Ant choice`<-ifelse(fall_2022_data_abandonment$`Ant choice`=="Correct"|fall_2022_data_abandonment$`Ant choice`=="Wrong","On trail","Abandoned")
fall_2022_data_abandonment<-data.frame(fall_2022_data_abandonment$Treatment,fall_2022_data_abandonment$`Ant choice`)
colnames(fall_2022_data_abandonment)<-c("treatment","choices")
fall_2023_data_abandonment<-data.frame(fall_2023_data$`Treatment (Control/Experimental)`,fall_2023_data$`Ant choice`)
colnames(fall_2023_data_abandonment)<-c("treatment","choices")
fall_2023_data_abandonment$choices<- ifelse(fall_2023_data_abandonment$choices=="Right"|fall_2023_data_abandonment$choices=="Left","On trail","Abandoned")
fall_2022_data_abandonment
fall_2023_data_abandonment
combined_abandonment_data<-rbind(fall_2022_data_abandonment,fall_2023_data_abandonment)
choice_freq_table_1<-table(combined_abandonment_data)
choice_freq_table_1
choice_freq_table
fall_2022_data
fall_2022_data %>%
group_by(Treatment,) %>%
count(`Ant choice`)
fall_2023_data_counting %>%
group_by(treatment,) %>%
count(choices)
fall_2022_data %>%
group_by(Treatment,) %>%
count(`Ant choice`)
fall_2023_data_counting %>%
group_by(treatment,) %>%
count(choices)
fall_2022_data %>%
group_by(Treatment,) %>%
count(`Ant choice`)
choice_freq_table
combined_choices
combined_choices
combined_choices
combined_choices
temp_choice<-c("Wrong","Correct","Correct","Wrong","Correct")
temp_treatment<-c("Experimental","Experimental","Experimental","Experimental","Control")
temp_data<-data.frame(temp_choice,temp_treatment)
temp_data
temp_data
temp_data<-data.frame(temp_treatment,temp_choice)
colnames(temp_data)<-c("treatment","choices")
temp_data
combined_choices_edited<-rbind(combined_choices,temp_data)
combined_choices_edited
choice_freq_table_edited<-table(combined_choices_edited)
choice_freq_table_edited
choice_freq_table
fisher.test(choice_freq_table_edited)
choice_freq_table_edited
combined_abandonment_data
combined_abandonment_data
temp_choice_1<-c("On trail","Abandoned","On trail","On trail","On trail","On trail","On trail","Abandoned","Abandoned","Abandoned")
temp_treatment_1<-c("Experimental","Experimental","Experimental","Experimental","Experimental","Control","Experimental","Experimental","Experimental","Experimental")
temp_abandon<-data.frame(temp_choice_1,temp_treatment_1)
colnames(temp_abandon)<-c("treatment","choices")
temp_abandon
combined_abandonment_data
temp_abandon<-data.frame(temp_treatment_1,temp_choice_1)
colnames(temp_abandon)<-c("treatment","choices")
temp_abandon
combined_abandonment_data_edited<-rbind(combined_abandonment_data,temp_abandon)
combined_abandonment_data_edited
combined_abandonment_data_edited
choice_freq_table_1_edited<-table(combined_abandonment_data_edited)
choice_freq_table_1_edited
choice_freq_table_1
choice_freq_table_1
choice_freq_table_1_edited
fisher.test(choice_freq_table_1_edited)
binom.test
choice_freq_table_1_edited
binom.test(35,45,0.5)
choice_freq_table_1
choice_freq_table_1_edited
choice_freq_table_1
binom.test(4,28,0.5)
choice_freq_table_1_edited
binom.test(35,45,0.5)
35/45
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(googlesheets4)
choice_freq_table_1_edited
fisher.test(choice_freq_table_1_edited)
choice_freq_table_edited
fisher.test(choice_freq_table_edited)
choice_freq_table_edited
remove(list=ls())
fall_2022_data<-read_sheet("https://docs.google.com/spreadsheets/d/1FPRGuBRdiHnLm_N69nAY1XQ4KUyYbEUaDxLwup3Zw-8/edit#gid=0")
fall_2022_data<-as.data.frame(fall_2022_data)
fall_2022_data$`Location of the ant`<-as.factor(fall_2022_data$`Location of the ant`)
fall_2022_data$`Ant choice`<-as.factor(fall_2022_data$`Ant choice`)
fall_2022_data$Treatment<-as.factor(fall_2022_data$Treatment)
fall_2022_data$Video<-as.factor(fall_2022_data$Video)
fall_2022_data$`Angle measurement 1`<-as.numeric(fall_2022_data$`Angle measurement 1`)
fall_2022_data$`Angle measurement 2`<-as.numeric(fall_2022_data$`Angle measurement 2`)
fall_2022_data$`Angle measurement 3`<-as.numeric(fall_2022_data$`Angle measurement 3`)
zone1_data<-subset(fall_2022_data,fall_2022_data$`Location of the ant`=="Zone1")
zone1_data$`Gaster touching the paper`<-as.factor(zone1_data$`Gaster touching the paper`)
zone1_data_modified<-zone1_data %>%
transmute(Video,Treatment,`Ant choice`,mean_gaster_angle=rowMeans(select(.,`Angle measurement 1`:`Angle measurement 3`)))
zone1_modified_byvideo<-zone1_data_modified %>%
group_by(Video,Treatment,`Ant choice`) %>%
summarise(mean_gaster_angle=mean(mean_gaster_angle,na.rm = T))
#This dataframe contains gaster angle and all the choices including abandonment
fall_2022_data<-zone1_modified_byvideo
#New dataframe to store the Treatment and choices data only(without abandonment data)
fall_2022_data_choices<-data.frame(fall_2022_data$Treatment,fall_2022_data$`Ant choice`)
fall_2022_data_choices<-subset(fall_2022_data_choices,fall_2022_data_choices$fall_2022_data..Ant.choice.!="Abandoned")
colnames(fall_2022_data_choices)<-c("treatment","choices")
fall_2022_data %>%
group_by(Treatment,) %>%
count(`Ant choice`)
fall_2023_data<-read_sheet("https://docs.google.com/spreadsheets/d/1UvuY_wv78jGxdG5KQwZlSYvwqsPIHxr0fkeslZk4AkM/edit#gid=0")
fall_2023_data<-as.data.frame(fall_2023_data)
fall_2023_data$`Ant choice`<-as.factor(fall_2023_data$`Ant choice`)
fall_2023_data$`Treatment (Control/Experimental)`<-as.factor(fall_2023_data$`Treatment (Control/Experimental)`)
fall_2023_data_counting<-data.frame(fall_2023_data$`Treatment (Control/Experimental)`,fall_2023_data$`Ant choice`)
fall_2023_data<-read_sheet("https://docs.google.com/spreadsheets/d/1UvuY_wv78jGxdG5KQwZlSYvwqsPIHxr0fkeslZk4AkM/edit#gid=0")
fall_2023_data<-as.data.frame(fall_2023_data)
fall_2023_data$`Ant choice`<-as.factor(fall_2023_data$`Ant choice`)
fall_2023_data$`Treatment (Control/Experimental)`<-as.factor(fall_2023_data$`Treatment (Control/Experimental)`)
#To count ant choices for the given treatment (for reporting in the manuscript writing)
fall_2023_data_counting<-data.frame(fall_2023_data$`Treatment (Control/Experimental)`,fall_2023_data$`Ant choice`)
colnames(fall_2023_data_counting)<-c("treatment","choices")
fall_2023_data_counting %>%
group_by(treatment,) %>%
count(choices)
#Since the correct and wrong choices are not explicitly recorded in the datasheet,the datasheet needs to be edited by removing data for abandoned ants, and putting correct and wrong choice labels depending on ant's choice and the feeder position.
fall_2023_data_choices<-subset(fall_2023_data,fall_2023_data$`Ant choice`!="Abandoned")
fall_2023_data_choices$`Ant choice`<- ifelse(fall_2023_data_choices$`Ant choice`==fall_2023_data_choices$`Side/arm of feeder`,"Correct","Wrong")
fall_2023_data_choices<-data.frame(fall_2023_data_choices$`Treatment (Control/Experimental)`,fall_2023_data_choices$`Ant choice`)
colnames(fall_2023_data_choices)<-c("treatment","choices")
fall_2023_data_choices %>%
group_by(treatment,) %>%
count(choices)
colnames(fall_2023_data_counting)<-c("treatment","choices")
fall_2023_data_counting %>%
group_by(treatment,) %>%
count(choices)
fall_2023_data_choices<-subset(fall_2023_data,fall_2023_data$`Ant choice`!="Abandoned")
fall_2023_data_choices$`Ant choice`<- ifelse(fall_2023_data_choices$`Ant choice`==fall_2023_data_choices$`Side/arm of feeder`,"Correct","Wrong")
fall_2023_data_choices<-data.frame(fall_2023_data_choices$`Treatment (Control/Experimental)`,fall_2023_data_choices$`Ant choice`)
colnames(fall_2023_data_choices)<-c("treatment","choices")
fall_2023_data_choices %>%
group_by(treatment,) %>%
count(choices)
#Combining the choices data from both seasons
combined_choices<-rbind(fall_2022_data_choices,fall_2023_data_choices)
#Removing uncessary factor levels.
combined_choices$choices<- droplevels(combined_choices$choices)
combined_choices
combined_choices
temp_choice<-c("Wrong","Correct","Correct","Wrong","Correct")
temp_treatment<-c("Experimental","Experimental","Experimental","Experimental","Control")
temp_data<-data.frame(temp_treatment,temp_choice)
colnames(temp_data)<-c("treatment","choices")
combined_choices_edited<-rbind(combined_choices,temp_data)
choice_freq_table_edited<-table(combined_choices_edited)
choice_freq_table_edited
#Combining the choices data from both seasons
combined_choices<-rbind(fall_2022_data_choices,fall_2023_data_choices)
#Removing uncessary factor levels.
combined_choices$choices<- droplevels(combined_choices$choices)
temp_choice<-c("Wrong","Correct","Correct","Wrong","Correct")
temp_treatment<-c("Experimental","Experimental","Experimental","Experimental","Control")
temp_data<-data.frame(temp_treatment,temp_choice)
colnames(temp_data)<-c("treatment","choices")
combined_choices_edited<-rbind(combined_choices,temp_data)
choice_freq_table_edited<-table(combined_choices_edited)
fisher.test(choice_freq_table_edited)
#Creating contingency table
choice_freq_table<-table(combined_choices)
choice_freq_table
choice_freq_table_edited
chisq.test(choice_freq_table_edited)
temp_choice<-c("Wrong","Correct","Wrong","Wrong","Correct","Wrong")
temp_treatment<-c("Experimental","Experimental","Experimental","Experimental","Control","Experimental")
temp_data<-data.frame(temp_treatment,temp_choice)
colnames(temp_data)<-c("treatment","choices")
combined_choices_edited<-rbind(combined_choices,temp_data)
choice_freq_table_edited<-table(combined_choices_edited)
fisher.test(choice_freq_table_edited)
choice_freq_table_edited
4/6
choice_freq_table_edited
binom.test(20,24,0.5)
choice_freq_table_edited
#experimental
binom.test(4,10,0.5)
choice_freq_table_edited
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(dplyr)
library(googlesheets4)
fall_2023_data_counting
binom.test(4,10,0.5)
binom.test(20,24,0.5)
fisher.test(choice_freq_table)
combined_choices
fall_2022_data<-read_sheet("https://docs.google.com/spreadsheets/d/1FPRGuBRdiHnLm_N69nAY1XQ4KUyYbEUaDxLwup3Zw-8/edit#gid=0")
fall_2022_data<-as.data.frame(fall_2022_data)
fall_2022_data$`Location of the ant`<-as.factor(fall_2022_data$`Location of the ant`)
fall_2022_data$`Ant choice`<-as.factor(fall_2022_data$`Ant choice`)
fall_2022_data$Treatment<-as.factor(fall_2022_data$Treatment)
fall_2022_data$Video<-as.factor(fall_2022_data$Video)
fall_2022_data$`Angle measurement 1`<-as.numeric(fall_2022_data$`Angle measurement 1`)
fall_2022_data$`Angle measurement 2`<-as.numeric(fall_2022_data$`Angle measurement 2`)
fall_2022_data$`Angle measurement 3`<-as.numeric(fall_2022_data$`Angle measurement 3`)
zone1_data<-subset(fall_2022_data,fall_2022_data$`Location of the ant`=="Zone1")
zone1_data$`Gaster touching the paper`<-as.factor(zone1_data$`Gaster touching the paper`)
zone1_data_modified<-zone1_data %>%
transmute(Video,Treatment,`Ant choice`,mean_gaster_angle=rowMeans(select(.,`Angle measurement 1`:`Angle measurement 3`)))
zone1_modified_byvideo<-zone1_data_modified %>%
group_by(Video,Treatment,`Ant choice`) %>%
summarise(mean_gaster_angle=mean(mean_gaster_angle,na.rm = T))
zone1_modified_byvideo<-as.data.frame(zone1_modified_byvideo)
#This dataframe contains gaster angle and all the choices including abandonment
fall_2022_data<-zone1_modified_byvideo
#New dataframe to store the Treatment and choices data only(without abandonment data)
fall_2022_data_choices<-data.frame(fall_2022_data$Treatment,fall_2022_data$`Ant choice`)
fall_2022_data_choices<-subset(fall_2022_data_choices,fall_2022_data_choices$fall_2022_data..Ant.choice.!="Abandoned")
colnames(fall_2022_data_choices)<-c("treatment","choices")
fall_2023_data<-read_sheet("https://docs.google.com/spreadsheets/d/1UvuY_wv78jGxdG5KQwZlSYvwqsPIHxr0fkeslZk4AkM/edit#gid=0")
fall_2023_data<-as.data.frame(fall_2023_data)
fall_2023_data$`Ant choice`<-as.factor(fall_2023_data$`Ant choice`)
fall_2023_data$`Treatment (Control/Experimental)`<-as.factor(fall_2023_data$`Treatment (Control/Experimental)`)
fall_2023_data_counting<-data.frame(fall_2023_data$`Treatment (Control/Experimental)`,fall_2023_data$`Ant choice`)
colnames(fall_2023_data_counting)<-c("treatment","choices")
fall_2023_data_counting %>%
group_by(treatment,) %>%
count(choices)
fall_2023_data_choices<-subset(fall_2023_data,fall_2023_data$`Ant choice`!="Abandoned")
fall_2023_data_choices$`Ant choice`<- ifelse(fall_2023_data_choices$`Ant choice`==fall_2023_data_choices$`Side/arm of feeder`,"Correct","Wrong")
fall_2023_data_choices<-data.frame(fall_2023_data_choices$`Treatment (Control/Experimental)`,fall_2023_data_choices$`Ant choice`)
colnames(fall_2023_data_choices)<-c("treatment","choices")
fall_2023_data_choices %>%
group_by(treatment,) %>%
count(choices)
#Combining the choices data from both seasons
combined_choices<-rbind(fall_2022_data_choices,fall_2023_data_choices)
#Removing uncessary factor levels.
combined_choices$choices<- droplevels(combined_choices$choices)
temp_choice<-c("Wrong","Correct","Wrong","Wrong","Correct","Wrong")
temp_treatment<-c("Experimental","Experimental","Experimental","Experimental","Control","Experimental")
temp_data<-data.frame(temp_treatment,temp_choice)
colnames(temp_data)<-c("treatment","choices")
#Combining these with the combined choice dataframe to create the final dataframe to analyze choices vs. treatments
combined_choices<-rbind(combined_choices,temp_data)
#Creating contingency table
choice_freq_table<-table(combined_choices)
fisher.test(choice_freq_table)
fall_2022_data %>%
group_by(Treatment,) %>%
count(`Ant choice`)
