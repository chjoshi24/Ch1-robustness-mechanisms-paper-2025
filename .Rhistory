group_by(Video,Treatment) %>%
summarise(mean_gaster_angle=mean(mean_gaster_angle,na.rm = T))
fall_2024_data_gaster_modified_3m<-as.data.frame(fall_2024_data_gaster_modified_3m)
fall_2024_data_gaster_modified_3m$year<-2024
combined_gaster_angle_3m<-rbind(fall_2023_data_gaster_modified_3m,fall_2024_data_gaster_modified_3m)
combined_gaster_angle_3m$f_year<-as.factor(combined_gaster_angle_3m$year)
combined_gaster_angle_3m %>%
group_by(Treatment)%>%
summarize(n(),median(mean_gaster_angle,na.rm=T))
wilcox.test(combined_gaster_angle_3m$mean_gaster_angle~combined_gaster_angle_3m$Treatment)
#Boxplot of the gaster angles
boxplot(combined_gaster_angle_3m$mean_gaster_angle~combined_gaster_angle_3m$Treatment,xlab="Treatment", ylab="Mean gaster angle (degrees)",range=0,frame=F,cex.axis=1.5,cex.lab=1.5)
stripchart(combined_gaster_angle_3m$mean_gaster_angle~combined_gaster_angle_3m$Treatment,method="jitter",add=T,vertical=T,pch=19)
par(mfrow=c(1,2))
#1.5m
#boxplot gaster angles
boxplot(combined_gaster_angle$mean_gaster_angle~combined_gaster_angle$Treatment,xlab="Treatment", ylab="Mean gaster angle (degrees)",range=0,frame=F,cex.axis=1.5,cex.lab=1.5,main="Low sucrose (1.5 M) experiment",ylim=c(35,65))
#adding individual points to the boxplot
stripchart(mean_gaster_angle~Treatment,method="jitter",add=T,vertical=T,pch=1,data=combined_gaster_angle[combined_gaster_angle$year==2022, ])
stripchart(mean_gaster_angle~Treatment,method="jitter",add=T,vertical=T,pch=19,data=combined_gaster_angle[combined_gaster_angle$year==2023, ])
stripchart(mean_gaster_angle~Treatment,method="jitter",add=T,vertical=T,pch=18,data=combined_gaster_angle[combined_gaster_angle$year==2024, ])
#3M
#Boxplot of the gaster angles
boxplot(combined_gaster_angle_3m$mean_gaster_angle~combined_gaster_angle_3m$Treatment,xlab="Treatment", ylab=NULL,range=0,frame=F,cex.axis=1.5,cex.lab=1.5,main="High sucrose (3 M) experiment",ylim=c(35,65),yaxt="n")
stripchart(mean_gaster_angle~Treatment,method="jitter",add=T,vertical=T,pch=19,data=combined_gaster_angle_3m[combined_gaster_angle_3m$year==2023, ])
stripchart(mean_gaster_angle~Treatment,method="jitter",add=T,vertical=T,pch=18,data=combined_gaster_angle_3m[combined_gaster_angle_3m$year==2024, ])
#Importing the datasheets,and converting the relevant columns into factors
low_sucrose_experiment_data<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1wCr7QqkCmjw9DGSQ6-SlD-O_suCwDQFs8sp-kTLeGmA/edit?gid=0#gid=0",sheet="Low sucrose experiment"))
high_sucrose_experiment_data<-as.data.frame(read_sheet("https://docs.google.com/spreadsheets/d/1wCr7QqkCmjw9DGSQ6-SlD-O_suCwDQFs8sp-kTLeGmA/edit?gid=0#gid=0",sheet="High sucrose experiment"))
#Extracting the columns needed for choice and abandonment analysis
low_sucrose_experiment_choices<-data.frame(low_sucrose_experiment_data$`Treatment (Control/Experimental)`,low_sucrose_experiment_data$`Ant choice`)
high_sucrose_experiment_choices<-data.frame(high_sucrose_experiment_data$`Treatment (Control/Experimental)`,high_sucrose_experiment_data$`Ant choice`)
#Changing the column names
colnames(low_sucrose_experiment_choices)<-c("treatment","choices")
colnames(high_sucrose_experiment_choices)<-c("treatment","choices")
#Converting the columns into factors
low_sucrose_experiment_choices$treatment<-as.factor(low_sucrose_experiment_choices$treatment)
low_sucrose_experiment_choices$choices<-as.factor(low_sucrose_experiment_choices$choices)
high_sucrose_experiment_choices$treatment<-as.factor(high_sucrose_experiment_choices$treatment)
high_sucrose_experiment_choices$choices<-as.factor(high_sucrose_experiment_choices$choices)
#1.5M DATA CHOICE ANALYSIS
#Filtering data where ant made either a correct or a wrong choice
low_sucrose_experiment_choices_only<-
low_sucrose_experiment_choices %>%
filter(choices !="Abandoned")
#Dropping the abandonment factor level
low_sucrose_experiment_choices_only$choices<-droplevels(low_sucrose_experiment_choices_only$choices)
#Creating table
low_sucrose_experiment_choices_only_table<-table(low_sucrose_experiment_choices_only)
chisq.test(low_sucrose_experiment_choices_only_table,correct = F)
#Binomial test for control data
binom.test(23,27,0.5)
#Significant!
#Binomial test for experimental data
binom.test(4,12,0.5)
#Non-significant
#3M DATA CHOICE ANALYSIS
#Filtering data where ant made either a correct or a wrong choice
high_sucrose_experiment_choices_only<-
high_sucrose_experiment_choices %>%
filter(choices !="Abandoned")
#Dropping the abandonment factor level
high_sucrose_experiment_choices_only$choices<-droplevels(high_sucrose_experiment_choices_only$choices)
#Creating table
high_sucrose_experiment_choices_only_table<-table(high_sucrose_experiment_choices_only)
chisq.test(high_sucrose_experiment_choices_only_table,correct = F)
#Significant
#Binomial test for control data
binom.test(25,31,0.5)
#Significant!
#Binomial test for experimental data
binom.test(9,18,0.5)
#Non-significant
#1.5M DATA ABANDONMENT ANALYSIS
#Filtering data where ant made either a correct or a wrong choice
low_sucrose_experiment_choices$abandonment<-ifelse(low_sucrose_experiment_choices$choices=="Abandoned","Abandoned","On-trail")
low_sucrose_experiment_abandonment_table<-table(low_sucrose_experiment_choices[-2])
#Chi-square test
chisq.test(low_sucrose_experiment_abandonment_table,correct = F)
#Significant
#Binomial test for control data
binom.test(5,32,0.5)
#Significantly more ants stay on the trail than abandon here
#Binomial test for experimental data
binom.test(39,51,0.5)
#Significantly more ants abandon the trail than stay on the trail
#3M DATA ABANDONMENT ANALYSIS
#Filtering data where ant made either a correct or a wrong choice
high_sucrose_experiment_choices$abandonment<-ifelse(high_sucrose_experiment_choices$choices=="Abandoned","Abandoned","On-trail")
high_sucrose_experiment_abandonment_table<-table(high_sucrose_experiment_choices[-2])
#Chi-square test
chisq.test(high_sucrose_experiment_abandonment_table,correct = F)
#Significant
#Binomial test for control data
binom.test(2,33,0.5) #Significant
#Significantly more ants stay on the trail than abandon here
#Binomial test for experimental data
binom.test(22,40,0.5)
#Non-significant
#Creating labels specific to the experiment type and combining the dataframes
low_sucrose_experiment_choices$label<-as.factor(ifelse(low_sucrose_experiment_choices$treatment=="Control","Control_1.5m","Exp_1.5m"))
high_sucrose_experiment_choices$label<-as.factor(ifelse(high_sucrose_experiment_choices$treatment=="Control","Control_3m","Exp_3m"))
all_exp_combined_data_choices<-rbind(low_sucrose_experiment_choices,high_sucrose_experiment_choices)
#Substting the data from the two treatments (combined for both experiments seperately) to compare between the experiments.
all_exp_combined_control<-subset(all_exp_combined_data_choices,all_exp_combined_data_choices$treatment=="Control")
all_exp_combined_experimental<-subset(all_exp_combined_data_choices,all_exp_combined_data_choices$treatment=="Experimental")
#Dropping the uncessary factor levels
all_exp_combined_control$label<-droplevels(all_exp_combined_control$label)
all_exp_combined_experimental$label<-droplevels(all_exp_combined_experimental$label)
#COMPARING CORRECT VS. WRONG CHOICES BETWEEN THE EXPERIMENTS FOR EACH TREATMENT
#CONTROL
all_exp_combined_control_choices_only<-data.frame(all_exp_combined_control$choices,all_exp_combined_control$label)
colnames(all_exp_combined_control_choices_only)<-c("choices","exp_type")
#Removing abandonment data for this analysis
all_exp_combined_control_choices_only<-subset(all_exp_combined_control_choices_only,all_exp_combined_control_choices_only$choices!="Abandoned")
#Dropping the uncessary factor levels
all_exp_combined_control_choices_only$choices<-droplevels(all_exp_combined_control_choices_only$choices)
all_exp_combined_control_choices_only_table<-table(all_exp_combined_control_choices_only)
chisq.test(all_exp_combined_control_choices_only_table,correct = F)
#Not significant
#EXPERIMENTAL
all_exp_combined_experimental_choices_only<-data.frame(all_exp_combined_experimental$choices,all_exp_combined_experimental$label)
colnames(all_exp_combined_experimental_choices_only)<-c("choices","exp_type")
#Removing abandonment data for this analysis
all_exp_combined_experimental_choices_only<-subset(all_exp_combined_experimental_choices_only,all_exp_combined_experimental_choices_only$choices!="Abandoned")
#Dropping the uncessary factor levels
all_exp_combined_experimental_choices_only$choices<-droplevels(all_exp_combined_experimental_choices_only$choices)
all_exp_combined_experimental_choices_only_table<-table(all_exp_combined_experimental_choices_only)
chisq.test(all_exp_combined_experimental_choices_only_table,correct = F)
#Not significant
#Plots
new_df<-subset(all_exp_combined_data_choices,choices!="Abandoned")
#Removing abandonment data for the plot
new_df$label<-factor(new_df$label,levels=c("Control_1.5m","Control_3m","Exp_1.5m","Exp_3m"))
new_df<-as.data.frame(new_df %>%
group_by(label,choices)%>%
summarize(total=n()))
choices_plot<-ggplot(new_df)+
aes(label,fill=choices,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_1.5m"="Control 1.5M","Control_3m"= "Control 3M", "Exp_1.5m"="Experimental 1.5M","Exp_3m" = "Experimental 3M"))+
xlab("Treatments")+
ylab("Percentage ants")+
guides(fill=guide_legend(title="Choices"))+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank()
) +  theme(axis.line = element_line(color = 'black'))
choices_plot+theme(text=element_text(size=25),axis.text = element_text(size=19))+
geom_hline(yintercept = 0.5, linetype = "dashed")+
scale_fill_manual(values=c("orange1","gray50"))
#Plotting only 1.5M choices
new_df_low_sucrose<-new_df[c(1,2,5,6),]
choices_plot_low_sucrose<-ggplot(new_df_low_sucrose)+
aes(label,fill=choices,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_1.5m"="Control", "Exp_1.5m"="Experimental"))+
ggtitle("Low sucrose experiment (1.5 M)")+
xlab("Treatments")+
ylab("Percentage ants")+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
legend.position = "none"
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_low_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=19))+
geom_hline(yintercept = 0.5, linetype = "dashed")
#Plotting only 3M choices
new_df_high_sucrose<-new_df[c(3,4,7,8),]
choices_plot_high_sucrose<-ggplot(new_df_high_sucrose)+
aes(label,fill=choices,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_3m"="Control", "Exp_3m"="Experimental"))+
ggtitle("High sucrose experiment (3 M)")+
xlab("Treatments")+
ylab("")+
guides(fill=guide_legend(title="Choices"))+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
axis.text.y = element_blank()
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_high_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=19))+
geom_hline(yintercept = 0.5, linetype = "dashed")
#CONTROL
all_exp_combined_control_abandonment_only<-data.frame(all_exp_combined_control$abandonment,all_exp_combined_control$label)
colnames(all_exp_combined_control_abandonment_only)<-c("abandonment","exp_type")
all_exp_combined_control_abandonment_only$abandonment<-as.factor(all_exp_combined_control_abandonment_only$abandonment)
all_exp_combined_control_abandonment_only_table<-table(all_exp_combined_control_abandonment_only)
chisq.test(all_exp_combined_control_abandonment_only_table,correct = F)
#Not significant
#Experimental
all_exp_combined_experimental_abandonment_only<-data.frame(all_exp_combined_experimental$abandonment,all_exp_combined_experimental$label)
colnames(all_exp_combined_experimental_abandonment_only)<-c("abandonment","exp_type")
all_exp_combined_experimental_abandonment_only$abandonment<-as.factor(all_exp_combined_experimental_abandonment_only$abandonment)
all_exp_combined_experimental_abandonment_only_table<-table(all_exp_combined_experimental_abandonment_only)
chisq.test(all_exp_combined_experimental_abandonment_only_table,correct = F)
#Significant!
#Plots
new_df_1<-as.data.frame(all_exp_combined_data_choices %>%
group_by(label,abandonment)%>%
summarize(total=n()))
new_df_1$label<-factor(new_df_1$label,levels=c("Control_1.5m","Control_3m","Exp_1.5m","Exp_3m"))
choices_plot_1<-ggplot(new_df_1)+
aes(label,fill=abandonment,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_1.5m"="Control 1.5M","Control_3m"= "Control 3M", "Exp_1.5m"="Experimental 1.5M","Exp_3m" = "Experimental 3M"))+
xlab("Treatments")+
ylab("Percentage ants")+
guides(fill=guide_legend(title="Abandoned or not"))+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank()
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_1+theme(text=element_text(size=25),axis.text = element_text(size=17))+geom_hline(yintercept = 0.5, linetype = "dashed")+scale_fill_manual(values=c("skyblue1","maroon3"))
#Plotting abandonment data only for low sucrose
new_df_1_low_sucrose<-new_df_1[c(1,2,3,4),]
choices_plot_1_low_sucrose<-ggplot(new_df_1_low_sucrose)+
aes(label,fill=abandonment,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_1.5m"="Control", "Exp_1.5m"="Experimental"))+ ggtitle("Low sucrose (1.5 M) experiment")+
xlab("Treatments")+
ylab("Percentage ants")+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
legend.position = "none"
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_1_low_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=17))+geom_hline(yintercept = 0.5, linetype = "dashed")+scale_fill_manual(values=c("lavender","hotpink2"))
#Plotting abandonment data only for high sucrose
new_df_1_high_sucrose<-new_df_1[c(5,6,7,8),]
choices_plot_1_high_sucrose<-ggplot(new_df_1_high_sucrose)+
aes(label,fill=abandonment,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_3m"="Control", "Exp_3m"="Experimental"))+ggtitle("High sucrose (3 M) experiment")+
xlab("Treatments")+
ylab("")+
guides(fill=guide_legend(title="Abandoned or not"))+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
axis.text.y = element_blank()
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_1_high_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=17))+geom_hline(yintercept = 0.5, linetype = "dashed")+scale_fill_manual(values=c("lavender","hotpink2"))
new_df_1<-as.data.frame(all_exp_combined_data_choices %>%
group_by(label,abandonment)%>%
summarize(total=n()))
new_df_1_low_sucrose<-new_df_1[c(1,2,3,4),]
choices_plot_1_low_sucrose<-ggplot(new_df_1_low_sucrose)+
aes(label,fill=abandonment,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_1.5m"="Control", "Exp_1.5m"="Trail removed"))+ ggtitle("Low sucrose (1.5 M) experiment")+
xlab("Treatments")+
ylab("Percentage ants")+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
legend.position = "none"
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_1_low_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=17))+geom_hline(yintercept = 0.5, linetype = "dashed")+scale_fill_manual(values=c("lavender","hotpink2"))
new_df_1_high_sucrose<-new_df_1[c(5,6,7,8),]
choices_plot_1_high_sucrose<-ggplot(new_df_1_high_sucrose)+
aes(label,fill=abandonment,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_3m"="Control", "Exp_3m"="Trail removed"))+ggtitle("High sucrose (3 M) experiment")+
xlab("Treatments")+
ylab("")+
guides(fill=guide_legend(title="Abandoned or not"))+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
axis.text.y = element_blank()
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_1_high_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=17))+geom_hline(yintercept = 0.5, linetype = "dashed")+scale_fill_manual(values=c("lavender","hotpink2"))
new_df_1_low_sucrose<-new_df_1[c(1,2,3,4),]
choices_plot_1_low_sucrose<-ggplot(new_df_1_low_sucrose)+
aes(label,fill=abandonment,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_1.5m"="Control", "Exp_1.5m"="Trail removed"))+ ggtitle("Low sucrose (1.5 M) experiment")+
xlab("Treatments")+
ylab("Percentage ants")+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
legend.position = "none"
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_1_low_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=17))+geom_hline(yintercept = 0.5, linetype = "dashed")+scale_fill_manual(values=c("lavender","hotpink2"))
new_df_1_low_sucrose<-new_df_1[c(1,2,3,4),]
choices_plot_1_low_sucrose<-ggplot(new_df_1_low_sucrose)+
aes(label,fill=abandonment,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_1.5m"="Control", "Exp_1.5m"="Trail removed"))+ ggtitle("Low sucrose (1.5 M) experiment")+
xlab("Treatments")+
ylab("Percentage ants")+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
legend.position = "none"
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_1_low_sucrose<-choices_plot_1_low_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=17))+geom_hline(yintercept = 0.5, linetype = "dashed")+scale_fill_manual(values=c("lavender","hotpink2"))
choices_plot_1_low_sucrose
new_df_1_high_sucrose<-new_df_1[c(5,6,7,8),]
choices_plot_1_high_sucrose<-ggplot(new_df_1_high_sucrose)+
aes(label,fill=abandonment,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_3m"="Control", "Exp_3m"="Trail removed"))+ggtitle("High sucrose (3 M) experiment")+
xlab("Treatments")+
ylab("")+
guides(fill=guide_legend(title="Abandoned or not"))+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
axis.text.y = element_blank()
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_1_high_sucrose<-choices_plot_1_high_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=17))+geom_hline(yintercept = 0.5, linetype = "dashed")+scale_fill_manual(values=c("lavender","hotpink2"))
choices_plot_1_low_sucrose+choices_plot_1_high_sucrose
choices_plot_1_low_sucrose + choices_plot_1_high_sucrose
library(ggpubr)
ggarange(choices_plot_1_low_sucrose,choices_plot_1_high_sucrose)
ggarrange(choices_plot_1_low_sucrose,choices_plot_1_high_sucrose)
ggarrange(choices_plot_1_low_sucrose,choices_plot_1_high_sucrose,ncol=2)
?ggarange
?ggarrange
ggarrange(choices_plot_1_low_sucrose,choices_plot_1_high_sucrose,align="v")
ggarrange(choices_plot_1_low_sucrose,choices_plot_1_high_sucrose,align="h")
?ggarra
?ggarrange
ggarrange(choices_plot_1_low_sucrose,choices_plot_1_high_sucrose,align="h",ncol=2)
install.packages("gridExtra")
library(gridExtra)
grid.arrange(choices_plot_1_low_sucrose,choices_plot_1_high_sucrose)
grid.arrange(choices_plot_1_low_sucrose,choices_plot_1_high_sucrose,ncol=2)
?grid.arrange
grid.arrange(choices_plot_1_low_sucrose,choices_plot_1_high_sucrose,ncol=2,heights=c(4,1))
grid.arrange(choices_plot_1_low_sucrose,choices_plot_1_high_sucrose,ncol=2,heights=c(4,1),widths=c(2,1))
grid.arrange(choices_plot_1_low_sucrose,choices_plot_1_high_sucrose,ncol=2,heights=c(1,1),widths=c(1,1))
new_df_1_low_sucrose<-new_df_1[c(1,2,3,4),]
choices_plot_1_low_sucrose<-ggplot(new_df_1_low_sucrose)+
aes(label,fill=abandonment,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_1.5m"="Control", "Exp_1.5m"="Trail removed"))+ ggtitle("Low sucrose (1.5 M) experiment")+
xlab("Treatments")+
ylab("Percentage ants")+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
legend.position = "none"
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_1_low_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=17))+geom_hline(yintercept = 0.5, linetype = "dashed")+scale_fill_manual(values=c("lavender","hotpink2"))
new_df_1_high_sucrose<-new_df_1[c(5,6,7,8),]
choices_plot_1_high_sucrose<-ggplot(new_df_1_high_sucrose)+
aes(label,fill=abandonment,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_3m"="Control", "Exp_3m"="Trail removed"))+ggtitle("High sucrose (3 M) experiment")+
xlab("Treatments")+
ylab("")+
guides(fill=guide_legend(title="Abandoned or not"))+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
axis.text.y = element_blank()
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_1_high_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=17))+geom_hline(yintercept = 0.5, linetype = "dashed")+scale_fill_manual(values=c("lavender","hotpink2"))
new_df_1_low_sucrose<-new_df_1[c(1,2,3,4),]
choices_plot_1_low_sucrose<-ggplot(new_df_1_low_sucrose)+
aes(label,fill=abandonment,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_1.5m"="Control", "Exp_1.5m"="Trail removed"))+ ggtitle("Low sucrose (1.5 M) experiment")+
xlab("Treatments")+
ylab("Percentage ants")+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
legend.position = "none"
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_1_low_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=17))+geom_hline(yintercept = 0.5, linetype = "dashed")+scale_fill_manual(values=c("lavender","hotpink2"))
#Plotting only 1.5M choices
new_df_low_sucrose<-new_df[c(1,2,5,6),]
choices_plot_low_sucrose<-ggplot(new_df_low_sucrose)+
aes(label,fill=choices,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_1.5m"="Control", "Exp_1.5m"="Trail removed"))+
ggtitle("Low sucrose experiment (1.5 M)")+
xlab("Treatments")+
ylab("Percentage ants")+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
legend.position = "none"
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_low_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=19))+
geom_hline(yintercept = 0.5, linetype = "dashed")
#Plotting only 1.5M choices
new_df_low_sucrose<-new_df[c(1,2,5,6),]
choices_plot_low_sucrose<-ggplot(new_df_low_sucrose)+
aes(label,fill=choices,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_1.5m"="Control", "Exp_1.5m"="Trail removed"))+
ggtitle("Low sucrose (1.5 M) experiment")+
xlab("Treatments")+
ylab("Percentage ants")+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
legend.position = "none"
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_low_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=19))+
geom_hline(yintercept = 0.5, linetype = "dashed")
#Plotting only 3M choices
new_df_high_sucrose<-new_df[c(3,4,7,8),]
choices_plot_high_sucrose<-ggplot(new_df_high_sucrose)+
aes(label,fill=choices,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_3m"="Control", "Exp_3m"="Trail removed"))+
ggtitle("High sucrose (3 M) experiment")+
xlab("Treatments")+
ylab("")+
guides(fill=guide_legend(title="Choices"))+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
axis.text.y = element_blank()
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_high_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=19))+
geom_hline(yintercept = 0.5, linetype = "dashed")
new_df_low_sucrose<-new_df[c(1,2,5,6),]
choices_plot_low_sucrose<-ggplot(new_df_low_sucrose)+
aes(label,fill=choices,weight=total,by=label)+
geom_bar(position="fill")+
geom_text(aes(label = scales::percent(..prop.., accuracy = 1)),stat = "prop", position = position_fill(.5),size=7)+
scale_y_continuous(labels = scales::percent)+scale_x_discrete(labels=c("Control_1.5m"="Control", "Exp_1.5m"="Trail removed"))+
ggtitle("Low sucrose (1.5 M) experiment")+
xlab("Treatments")+
ylab("Percentage ants")+
theme_bw()+
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
legend.position = "none"
) +  theme(axis.line = element_line(color = 'black'))
choices_plot_low_sucrose+theme(text=element_text(size=25),axis.text = element_text(size=19))+
geom_hline(yintercept = 0.5, linetype = "dashed")
